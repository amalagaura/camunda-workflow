---
http_interactions:
- request:
    method: post
    uri: http://localhost:8080/rest/process-definition/key/CamundaWorkflow/tenant-id/test-environment/start
    body:
      encoding: UTF-8
      string: '{"businessKey":"Key"}'
    headers:
      User-Agent:
      - Faraday v0.17.0
      Content-Type:
      - application/json
  response:
    status:
      code: 200
      message: ''
    headers:
      content-type:
      - application/json
      content-length:
      - '351'
      date:
      - Fri, 22 Nov 2019 21:23:31 GMT
      connection:
      - close
    body:
      encoding: UTF-8
      string: '{"links":[{"method":"GET","href":"http://localhost:8080/rest/process-instance/55af80ec-0d6e-11ea-b338-acde48001122","rel":"self"}],"id":"55af80ec-0d6e-11ea-b338-acde48001122","definitionId":"CamundaWorkflow:1:55aaed0b-0d6e-11ea-b338-acde48001122","businessKey":"Key","caseInstanceId":null,"ended":false,"suspended":false,"tenantId":"test-environment"}'
    http_version: 
  recorded_at: Fri, 22 Nov 2019 21:23:32 GMT
- request:
    method: post
    uri: http://localhost:8080/rest/external-task/fetchAndLock
    body:
      encoding: UTF-8
      string: '{"workerId":"0","maxTasks":2,"asyncResponseTimeout":30000,"topics":[{"topicName":"CamundaWorkflow","lockDuration":1209600000}]}'
    headers:
      User-Agent:
      - Faraday v0.17.0
      Content-Type:
      - application/json
  response:
    status:
      code: 200
      message: ''
    headers:
      content-type:
      - application/json
      content-length:
      - '661'
      date:
      - Fri, 22 Nov 2019 21:23:31 GMT
      connection:
      - close
    body:
      encoding: UTF-8
      string: '[{"activityId":"DoSomething","activityInstanceId":"DoSomething:55afa704-0d6e-11ea-b338-acde48001122","errorMessage":null,"errorDetails":null,"executionId":"55afa703-0d6e-11ea-b338-acde48001122","id":"55afa705-0d6e-11ea-b338-acde48001122","lockExpirationTime":"2019-12-06T16:23:32.351-0500","processDefinitionId":"CamundaWorkflow:1:55aaed0b-0d6e-11ea-b338-acde48001122","processDefinitionKey":"CamundaWorkflow","processDefinitionVersionTag":null,"processInstanceId":"55af80ec-0d6e-11ea-b338-acde48001122","retries":null,"suspended":false,"workerId":"0","topicName":"CamundaWorkflow","tenantId":"test-environment","variables":{},"priority":0,"businessKey":"Key"}]'
    http_version: 
  recorded_at: Fri, 22 Nov 2019 21:23:32 GMT
- request:
    method: post
    uri: http://localhost:8080/rest/external-task/55afa705-0d6e-11ea-b338-acde48001122/failure
    body:
      encoding: UTF-8
      string: '{"workerId":"0","errorMessage":"This broke","errorDetails":"Input variables
        are {:x=>\"abcd\"}\n\n\u001b[1mTraceback\u001b[m (most recent call last):\n\t69:
        from /Users/asethi/.rvm/gems/ruby-2.6.5/bin/bundle:23:in `<main>''\n\t68:
        from /Users/asethi/.rvm/gems/ruby-2.6.5/bin/bundle:23:in `load''\n\t67: from
        /Users/asethi/.rvm/gems/ruby-2.6.5/gems/bundler-2.0.2/exe/bundle:22:in `<top
        (required)>''\n\t66: from /Users/asethi/.rvm/gems/ruby-2.6.5/gems/bundler-2.0.2/lib/bundler/friendly_errors.rb:124:in
        `with_friendly_errors''\n\t65: from /Users/asethi/.rvm/gems/ruby-2.6.5/gems/bundler-2.0.2/exe/bundle:30:in
        `block in <top (required)>''\n\t64: from /Users/asethi/.rvm/gems/ruby-2.6.5/gems/bundler-2.0.2/lib/bundler/cli.rb:18:in
        `start''\n\t63: from /Users/asethi/.rvm/gems/ruby-2.6.5/gems/bundler-2.0.2/lib/bundler/vendor/thor/lib/thor/base.rb:466:in
        `start''\n\t62: from /Users/asethi/.rvm/gems/ruby-2.6.5/gems/bundler-2.0.2/lib/bundler/cli.rb:27:in
        `dispatch''\n\t61: from /Users/asethi/.rvm/gems/ruby-2.6.5/gems/bundler-2.0.2/lib/bundler/vendor/thor/lib/thor.rb:387:in
        `dispatch''\n\t60: from /Users/asethi/.rvm/gems/ruby-2.6.5/gems/bundler-2.0.2/lib/bundler/vendor/thor/lib/thor/invocation.rb:126:in
        `invoke_command''\n\t59: from /Users/asethi/.rvm/gems/ruby-2.6.5/gems/bundler-2.0.2/lib/bundler/vendor/thor/lib/thor/command.rb:27:in
        `run''\n\t58: from /Users/asethi/.rvm/gems/ruby-2.6.5/gems/bundler-2.0.2/lib/bundler/cli.rb:465:in
        `exec''\n\t57: from /Users/asethi/.rvm/gems/ruby-2.6.5/gems/bundler-2.0.2/lib/bundler/cli/exec.rb:28:in
        `run''\n\t56: from /Users/asethi/.rvm/gems/ruby-2.6.5/gems/bundler-2.0.2/lib/bundler/cli/exec.rb:74:in
        `kernel_load''\n\t55: from /Users/asethi/.rvm/gems/ruby-2.6.5/gems/bundler-2.0.2/lib/bundler/cli/exec.rb:74:in
        `load''\n\t54: from /Users/asethi/.rvm/gems/ruby-2.6.5/bin/rspec:23:in `<top
        (required)>''\n\t53: from /Users/asethi/.rvm/gems/ruby-2.6.5/bin/rspec:23:in
        `load''\n\t52: from /Users/asethi/.rvm/gems/ruby-2.6.5/gems/rspec-core-3.9.0/exe/rspec:4:in
        `<top (required)>''\n\t51: from /Users/asethi/.rvm/gems/ruby-2.6.5/gems/rspec-core-3.9.0/lib/rspec/core/runner.rb:45:in
        `invoke''\n\t50: from /Users/asethi/.rvm/gems/ruby-2.6.5/gems/rspec-core-3.9.0/lib/rspec/core/runner.rb:71:in
        `run''\n\t49: from /Users/asethi/.rvm/gems/ruby-2.6.5/gems/rspec-core-3.9.0/lib/rspec/core/runner.rb:89:in
        `run''\n\t48: from /Users/asethi/.rvm/gems/ruby-2.6.5/gems/rspec-core-3.9.0/lib/rspec/core/runner.rb:115:in
        `run_specs''\n\t47: from /Users/asethi/.rvm/gems/ruby-2.6.5/gems/rspec-core-3.9.0/lib/rspec/core/reporter.rb:74:in
        `report''\n\t46: from /Users/asethi/.rvm/gems/ruby-2.6.5/gems/rspec-core-3.9.0/lib/rspec/core/runner.rb:116:in
        `block in run_specs''\n\t45: from /Users/asethi/.rvm/gems/ruby-2.6.5/gems/rspec-core-3.9.0/lib/rspec/core/configuration.rb:2031:in
        `with_suite_hooks''\n\t44: from /Users/asethi/.rvm/gems/ruby-2.6.5/gems/rspec-core-3.9.0/lib/rspec/core/runner.rb:121:in
        `block (2 levels) in run_specs''\n\t43: from /Users/asethi/.rvm/gems/ruby-2.6.5/gems/rspec-core-3.9.0/lib/rspec/core/runner.rb:121:in
        `map''\n\t42: from /Users/asethi/.rvm/gems/ruby-2.6.5/gems/rspec-core-3.9.0/lib/rspec/core/runner.rb:121:in
        `block (3 levels) in run_specs''\n\t41: from /Users/asethi/.rvm/gems/ruby-2.6.5/gems/rspec-core-3.9.0/lib/rspec/core/example_group.rb:596:in
        `run''\n\t40: from /Users/asethi/.rvm/gems/ruby-2.6.5/gems/rspec-core-3.9.0/lib/rspec/core/example_group.rb:596:in
        `map''\n\t39: from /Users/asethi/.rvm/gems/ruby-2.6.5/gems/rspec-core-3.9.0/lib/rspec/core/example_group.rb:596:in
        `block in run''\n\t38: from /Users/asethi/.rvm/gems/ruby-2.6.5/gems/rspec-core-3.9.0/lib/rspec/core/example_group.rb:595:in
        `run''\n\t37: from /Users/asethi/.rvm/gems/ruby-2.6.5/gems/rspec-core-3.9.0/lib/rspec/core/example_group.rb:629:in
        `run_examples''\n\t36: from /Users/asethi/.rvm/gems/ruby-2.6.5/gems/rspec-core-3.9.0/lib/rspec/core/example_group.rb:629:in
        `map''\n\t35: from /Users/asethi/.rvm/gems/ruby-2.6.5/gems/rspec-core-3.9.0/lib/rspec/core/example_group.rb:633:in
        `block in run_examples''\n\t34: from /Users/asethi/.rvm/gems/ruby-2.6.5/gems/rspec-core-3.9.0/lib/rspec/core/example.rb:254:in
        `run''\n\t33: from /Users/asethi/.rvm/gems/ruby-2.6.5/gems/rspec-core-3.9.0/lib/rspec/core/example.rb:503:in
        `with_around_and_singleton_context_hooks''\n\t32: from /Users/asethi/.rvm/gems/ruby-2.6.5/gems/rspec-core-3.9.0/lib/rspec/core/example.rb:460:in
        `with_around_example_hooks''\n\t31: from /Users/asethi/.rvm/gems/ruby-2.6.5/gems/rspec-core-3.9.0/lib/rspec/core/hooks.rb:472:in
        `run''\n\t30: from /Users/asethi/.rvm/gems/ruby-2.6.5/gems/rspec-core-3.9.0/lib/rspec/core/hooks.rb:615:in
        `run_around_example_hooks_for''\n\t29: from /Users/asethi/.rvm/gems/ruby-2.6.5/gems/rspec-core-3.9.0/lib/rspec/core/example.rb:345:in
        `call''\n\t28: from /Users/asethi/.rvm/gems/ruby-2.6.5/gems/rspec-core-3.9.0/lib/rspec/core/hooks.rb:614:in
        `block (2 levels) in run_around_example_hooks_for''\n\t27: from /Users/asethi/.rvm/gems/ruby-2.6.5/gems/rspec-core-3.9.0/lib/rspec/core/hooks.rb:381:in
        `execute_with''\n\t26: from /Users/asethi/.rvm/gems/ruby-2.6.5/gems/rspec-core-3.9.0/lib/rspec/core/example.rb:450:in
        `instance_exec''\n\t25: from /Users/asethi/.rvm/gems/ruby-2.6.5/gems/rspec-core-3.9.0/lib/rspec/core/example.rb:450:in
        `instance_exec''\n\t24: from /Users/asethi/Projects/camunda-workflow/spec/spec_helper.rb:126:in
        `block (2 levels) in <top (required)>''\n\t23: from /Users/asethi/.rvm/gems/ruby-2.6.5/gems/vcr-5.0.0/lib/vcr.rb:188:in
        `use_cassette''\n\t22: from /Users/asethi/.rvm/gems/ruby-2.6.5/gems/vcr-5.0.0/lib/vcr/util/variable_args_block_caller.rb:9:in
        `call_block''\n\t21: from /Users/asethi/Projects/camunda-workflow/spec/spec_helper.rb:128:in
        `block (3 levels) in <top (required)>''\n\t20: from /Users/asethi/.rvm/gems/ruby-2.6.5/gems/rspec-core-3.9.0/lib/rspec/core/example.rb:345:in
        `call''\n\t19: from /Users/asethi/.rvm/gems/ruby-2.6.5/gems/rspec-core-3.9.0/lib/rspec/core/hooks.rb:612:in
        `block in run_around_example_hooks_for''\n\t18: from /Users/asethi/.rvm/gems/ruby-2.6.5/gems/rspec-core-3.9.0/lib/rspec/core/hooks.rb:472:in
        `block in run''\n\t17: from /Users/asethi/.rvm/gems/ruby-2.6.5/gems/rspec-core-3.9.0/lib/rspec/core/example.rb:460:in
        `block in with_around_example_hooks''\n\t16: from /Users/asethi/.rvm/gems/ruby-2.6.5/gems/rspec-core-3.9.0/lib/rspec/core/example.rb:503:in
        `block in with_around_and_singleton_context_hooks''\n\t15: from /Users/asethi/.rvm/gems/ruby-2.6.5/gems/rspec-core-3.9.0/lib/rspec/core/example.rb:257:in
        `block in run''\n\t14: from /Users/asethi/.rvm/gems/ruby-2.6.5/gems/rspec-core-3.9.0/lib/rspec/core/example.rb:257:in
        `instance_exec''\n\t13: from /Users/asethi/Projects/camunda-workflow/spec/unit/external_task_job_spec.rb:38:in
        `block (3 levels) in <top (required)>''\n\t12: from /Users/asethi/.rvm/gems/ruby-2.6.5/gems/rspec-core-3.9.0/lib/rspec/core/memoized_helpers.rb:119:in
        `is_expected''\n\t11: from /Users/asethi/.rvm/gems/ruby-2.6.5/gems/rspec-core-3.9.0/lib/rspec/core/memoized_helpers.rb:317:in
        `block in let''\n\t10: from /Users/asethi/.rvm/gems/ruby-2.6.5/gems/rspec-core-3.9.0/lib/rspec/core/memoized_helpers.rb:155:in
        `fetch_or_store''\n\t 9: from /Users/asethi/.rvm/gems/ruby-2.6.5/gems/rspec-core-3.9.0/lib/rspec/core/memoized_helpers.rb:155:in
        `fetch''\n\t 8: from /Users/asethi/.rvm/gems/ruby-2.6.5/gems/rspec-core-3.9.0/lib/rspec/core/memoized_helpers.rb:156:in
        `block in fetch_or_store''\n\t 7: from /Users/asethi/.rvm/gems/ruby-2.6.5/gems/rspec-support-3.9.0/lib/rspec/support/reentrant_mutex.rb:23:in
        `synchronize''\n\t 6: from /Users/asethi/.rvm/gems/ruby-2.6.5/gems/rspec-core-3.9.0/lib/rspec/core/memoized_helpers.rb:157:in
        `block (2 levels) in fetch_or_store''\n\t 5: from /Users/asethi/.rvm/gems/ruby-2.6.5/gems/rspec-core-3.9.0/lib/rspec/core/memoized_helpers.rb:157:in
        `fetch''\n\t 4: from /Users/asethi/.rvm/gems/ruby-2.6.5/gems/rspec-core-3.9.0/lib/rspec/core/memoized_helpers.rb:157:in
        `block (3 levels) in fetch_or_store''\n\t 3: from /Users/asethi/.rvm/gems/ruby-2.6.5/gems/rspec-core-3.9.0/lib/rspec/core/memoized_helpers.rb:317:in
        `block (2 levels) in let''\n\t 2: from /Users/asethi/Projects/camunda-workflow/spec/unit/external_task_job_spec.rb:6:in
        `block (2 levels) in <top (required)>''\n\t 1: from /Users/asethi/Projects/camunda-workflow/lib/camunda/external_task_job.rb:3:in
        `perform''\n/Users/asethi/Projects/camunda-workflow/spec/unit/external_task_job_spec.rb:33:in
        `bpmn_perform'': \u001b[1mThis broke (\u001b[1;4mStandardError\u001b[m\u001b[1m)\u001b[m\n"}'
    headers:
      User-Agent:
      - Faraday v0.17.0
      Content-Type:
      - application/json
  response:
    status:
      code: 204
      message: ''
    headers:
      date:
      - Fri, 22 Nov 2019 21:23:31 GMT
      connection:
      - close
    body:
      encoding: UTF-8
      string: ''
    http_version: 
  recorded_at: Fri, 22 Nov 2019 21:23:32 GMT
- request:
    method: get
    uri: http://localhost:8080/rest/incident?activityId=DoSomething&processInstanceId=55af80ec-0d6e-11ea-b338-acde48001122
    body:
      encoding: US-ASCII
      string: ''
    headers:
      User-Agent:
      - Faraday v0.17.0
  response:
    status:
      code: 200
      message: ''
    headers:
      content-type:
      - application/json
      content-length:
      - '609'
      date:
      - Fri, 22 Nov 2019 21:23:31 GMT
      connection:
      - close
    body:
      encoding: UTF-8
      string: '[{"id":"55b3c5ba-0d6e-11ea-b338-acde48001122","processDefinitionId":"CamundaWorkflow:1:55aaed0b-0d6e-11ea-b338-acde48001122","processInstanceId":"55af80ec-0d6e-11ea-b338-acde48001122","executionId":"55afa703-0d6e-11ea-b338-acde48001122","incidentTimestamp":"2019-11-22T16:23:32.363-0500","incidentType":"failedExternalTask","activityId":"DoSomething","causeIncidentId":"55b3c5ba-0d6e-11ea-b338-acde48001122","rootCauseIncidentId":"55b3c5ba-0d6e-11ea-b338-acde48001122","configuration":"55afa705-0d6e-11ea-b338-acde48001122","incidentMessage":"This
        broke","tenantId":"test-environment","jobDefinitionId":null}]'
    http_version: 
  recorded_at: Fri, 22 Nov 2019 21:23:32 GMT
recorded_with: VCR 5.0.0
